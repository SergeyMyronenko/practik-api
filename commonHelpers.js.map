{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["// https://unsplash.com/documentation#search-photos\n\nimport axios from 'axios';\nimport { Spinner } from 'spin.js';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst formEl = document.querySelector('.js-search-form');\nconst listEl = document.querySelector('.js-gallery');\nconst target = document.querySelector('.js-backdrop');\nlet page = 1;\nlet query;\n\nconst opts = {\n  lines: 14, // The number of lines to draw\n  length: 41, // The length of each line\n  width: 17, // The line thickness\n  radius: 45, // The radius of the inner circle\n  scale: 1, // Scales overall size of the spinner\n  corners: 1, // Corner roundness (0..1)\n  speed: 1, // Rounds per second\n  rotate: 24, // The rotation offset\n  animation: 'spinner-line-fade-quick', // The CSS animation name for the lines\n  direction: 1, // 1: clockwise, -1: counterclockwise\n  color: '#f01919', // CSS color or array of colors\n  fadeColor: 'transparent', // CSS color or array of colors\n  top: '50%', // Top position relative to parent\n  left: '50%', // Left position relative to parent\n  shadow: '0 0 1px transparent', // Box-shadow for the lines\n  zIndex: 2000000000, // The z-index (defaults to 2e9)\n  className: 'spinner', // The CSS class to assign to the spinner\n  position: 'absolute', // Element positioning\n};\n\nconst options = {\n  root: null,\n  rootMargin: '100px',\n  threshold: 1.0,\n};\n\nconst callback = function (entries, observer) {\n  entries.forEach(entry => {\n    if (entry.isIntersecting) {\n      observer.unobserve(entry.target);\n      loadMoreData();\n    }\n  });\n};\n\nconst observer = new IntersectionObserver(callback, options);\nconst spinner = new Spinner(opts);\n\nformEl.addEventListener('submit', onSubmit);\n\nasync function onSubmit(event) {\n  event.preventDefault();\n  query = event.target.elements['user-search-query'].value.trim();\n  spinnerPlay();\n  if (!query) {\n    spinnerStop();\n    listEl.innerHTML = '';\n    return iziToast.info({\n      position: 'topRight',\n      message: 'Error enter any symbols',\n    });\n  }\n\n  try {\n    const {\n      data: { results, total },\n    } = await getPhotos(query, page);\n    listEl.innerHTML = createMarkup(results);\n    iziToast.success({\n      position: 'topRight',\n      message: `We found ${total} photos`,\n    });\n    const item = document.querySelector('.gallery__item:last-child');\n    observer.observe(item);\n  } catch (error) {\n    console.log('Error');\n  } finally {\n    spinnerStop();\n  }\n  event.target.reset();\n}\n\nfunction spinnerPlay() {\n  spinner.spin(target);\n  target.classList.remove('is-hidden');\n}\nfunction spinnerStop() {\n  spinner.stop();\n  target.classList.add('is-hidden');\n}\n\nfunction createMarkup(arr = []) {\n  return arr\n    .map(\n      photo => `<li class='gallery__item'>\n  <img src='${photo.urls.small}' alt='${photo.alt_description}' class='gallery-img' />\n</li>`\n    )\n    .join('');\n}\n\nfunction getPhotos(query, page) {\n  axios.defaults.baseURL = 'https://api.unsplash.com';\n  axios.defaults.headers.common['Authorization'] =\n    'Client-ID LxvKVGJqiSe6NcEVZOaLXC-f2JIIWZaq_o0WrF8mwJc';\n\n  return axios.get('/search/photos', {\n    params: {\n      query,\n      page,\n      per_page: 12,\n      orientation: 'portrait',\n    },\n  });\n}\n\nasync function loadMoreData() {\n  console.log('LOAD');\n  page += 1;\n  spinnerPlay();\n\n  try {\n    const {\n      data: { results, total_page },\n    } = await getPhotos(query, page);\n    listEl.insertAdjacentHTML('beforeend', createMarkup(results));\n    const item = document.querySelector('.gallery__item:last-child');\n    observer.observe(item);\n  } catch (error) {\n    console.log(error);\n  } finally {\n    spinnerStop();\n  }\n}\n"],"names":["formEl","listEl","target","page","query","opts","options","callback","entries","observer","entry","loadMoreData","spinner","Spinner","onSubmit","event","spinnerPlay","spinnerStop","iziToast","results","total","getPhotos","createMarkup","item","arr","photo","axios","total_page","error"],"mappings":"owBAOA,MAAMA,EAAS,SAAS,cAAc,iBAAiB,EACjDC,EAAS,SAAS,cAAc,aAAa,EAC7CC,EAAS,SAAS,cAAc,cAAc,EACpD,IAAIC,EAAO,EACPC,EAEJ,MAAMC,EAAO,CACX,MAAO,GACP,OAAQ,GACR,MAAO,GACP,OAAQ,GACR,MAAO,EACP,QAAS,EACT,MAAO,EACP,OAAQ,GACR,UAAW,0BACX,UAAW,EACX,MAAO,UACP,UAAW,cACX,IAAK,MACL,KAAM,MACN,OAAQ,sBACR,OAAQ,IACR,UAAW,UACX,SAAU,UACZ,EAEMC,EAAU,CACd,KAAM,KACN,WAAY,QACZ,UAAW,CACb,EAEMC,EAAW,SAAUC,EAASC,EAAU,CAC5CD,EAAQ,QAAQE,GAAS,CACnBA,EAAM,iBACRD,EAAS,UAAUC,EAAM,MAAM,EAC/BC,IAEN,CAAG,CACH,EAEMF,EAAW,IAAI,qBAAqBF,EAAUD,CAAO,EACrDM,EAAU,IAAIC,EAAQR,CAAI,EAEhCL,EAAO,iBAAiB,SAAUc,CAAQ,EAE1C,eAAeA,EAASC,EAAO,CAI7B,GAHAA,EAAM,eAAc,EACpBX,EAAQW,EAAM,OAAO,SAAS,qBAAqB,MAAM,OACzDC,IACI,CAACZ,EACH,OAAAa,IACAhB,EAAO,UAAY,GACZiB,EAAS,KAAK,CACnB,SAAU,WACV,QAAS,yBACf,CAAK,EAGH,GAAI,CACF,KAAM,CACJ,KAAM,CAAE,QAAAC,EAAS,MAAAC,CAAO,CACzB,EAAG,MAAMC,EAAUjB,EAAOD,CAAI,EAC/BF,EAAO,UAAYqB,EAAaH,CAAO,EACvCD,EAAS,QAAQ,CACf,SAAU,WACV,QAAS,YAAYE,UAC3B,CAAK,EACD,MAAMG,EAAO,SAAS,cAAc,2BAA2B,EAC/Dd,EAAS,QAAQc,CAAI,CACtB,MAAC,CACA,QAAQ,IAAI,OAAO,CACvB,QAAY,CACRN,GACD,CACDF,EAAM,OAAO,OACf,CAEA,SAASC,GAAc,CACrBJ,EAAQ,KAAKV,CAAM,EACnBA,EAAO,UAAU,OAAO,WAAW,CACrC,CACA,SAASe,GAAc,CACrBL,EAAQ,KAAI,EACZV,EAAO,UAAU,IAAI,WAAW,CAClC,CAEA,SAASoB,EAAaE,EAAM,GAAI,CAC9B,OAAOA,EACJ,IACCC,GAAS;AAAA,cACDA,EAAM,KAAK,eAAeA,EAAM;AAAA,MAEzC,EACA,KAAK,EAAE,CACZ,CAEA,SAASJ,EAAUjB,EAAOD,EAAM,CAC9B,OAAAuB,EAAM,SAAS,QAAU,2BACzBA,EAAM,SAAS,QAAQ,OAAO,cAC5B,wDAEKA,EAAM,IAAI,iBAAkB,CACjC,OAAQ,CACN,MAAAtB,EACA,KAAAD,EACA,SAAU,GACV,YAAa,UACd,CACL,CAAG,CACH,CAEA,eAAeQ,GAAe,CAC5B,QAAQ,IAAI,MAAM,EAClBR,GAAQ,EACRa,IAEA,GAAI,CACF,KAAM,CACJ,KAAM,CAAE,QAAAG,EAAS,WAAAQ,CAAY,CAC9B,EAAG,MAAMN,EAAUjB,EAAOD,CAAI,EAC/BF,EAAO,mBAAmB,YAAaqB,EAAaH,CAAO,CAAC,EAC5D,MAAMI,EAAO,SAAS,cAAc,2BAA2B,EAC/Dd,EAAS,QAAQc,CAAI,CACtB,OAAQK,EAAP,CACA,QAAQ,IAAIA,CAAK,CACrB,QAAY,CACRX,GACD,CACH"}